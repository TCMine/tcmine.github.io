warning: this is a mess lol
